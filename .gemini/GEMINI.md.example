# Antigravity Agent OS - 全局配置模板 (GEMINI.md)

> **注意**: 请将此文件内容复制到你系统全局的 `.gemini/GEMINI.md` 文件中。
> 在 Windows 上通常位于 `C:\Users\YourName\.gemini\GEMINI.md`。

---

## 0. 强制语言规则 (Mandatory)
- **语言**: 全程使用中文对话，包括代码注释、文件命名、任务描述、思考过程。
- **简洁**: 禁止解释标准库用法，禁止复述显而易见的代码变更。

---

## 1. 启动协议 (Boot Protocol)
> **Trigger**: 每次新会话开始时自动执行。

### 1.1 项目级配置检测
当工作目录下存在 `.agent/` 目录时：
1. **读取记忆**: 立即调用 `view_file` 读取 `.agent/memory/active_context.md`
2. **检查状态**: 解析 YAML frontmatter 中的 `task_status` 字段
3. **恢复上下文**: 提示系统状态并询问是否继续任务。

---

## 2. 工作流触发器 (Workflow Triggers)
| 用户输入模式 | 触发工作流 | 描述 |
|------------|-----------|-----|
| "继续" / "开始" / "早" | `/start` | 静默启动，恢复上下文 |
| 描述新功能需求 | `prd-crafter-lite` | 生成 PRD 文档 |
| "确认" / "Go" / "OK" | `feature-flow` | 启动全自动交付流水线 |
| "暂停" / "保存" | `/suspend` | 保存状态，生成总结 |
| 粘贴错误日志 | `/analyze-error` | 🔥 智能错误分析 |
| "进化" / "学习" | `/evolve` | 🧬 触发进化引擎 |
| "反思" / "总结" | `/reflect` | 💭 触发反思工作流 |
| "状态" / "进度" | `/status` | 📊 显示系统状态 |
| "回滚" / "撤销" | `/rollback` | ⏪ 回滚到检查点 |
| "知识 [query]" | `/knowledge` | 📚 查询知识库 |
| "模式 [query]" | `/patterns` | 🔄 查询代码模式库 |
| "/meta [desc]" 或 "系统改进" | `/meta` | 🔧 修改 Agent OS 系统 |
| "/export" 或 "导出系统" | `/export` | 📦 导出可移植压缩包 |

---

## 3. 门禁规则 (Gatekeeper Rules)
- **需求澄清门禁**: 用户需求存在歧义时强制反问。
- **PRD 确认门禁**: PRD 生成后必须用户明确确认方可编码。
- **编译提交门禁**: 代码修改后必须执行编译和测试，通过后自动提交。

---

## 4. 进化引擎自动行为 (Evolution Auto Behaviors)
| 触发事件 | 自动行为 |
|---------|---------|
| 任务完成 | 将代码变更加入 `learning_queue.md` |
| 错误修复成功 | 将错误修复加入学习队列 (P1) |
| 工作流完成 | 更新 `workflow_metrics.md` 指标 |
| 状态 → ARCHIVING | 自动触发 `/reflect` 工作流 |

---

_Last Updated: 2026-02-08_
